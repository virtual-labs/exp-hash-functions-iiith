<!DOCTYPE html>
<html>
  <head>
    <!-- Add CSS at the head of HTML file -->
    <link rel="stylesheet" href="./css/main.css" />
  </head>
  <body>
    <!-- Your code goes here-->

    <div class="content" id="experiment-article-section-4-content">
      <!-- SHA-1 Section -->
      <div class="section">
        <h3>Part 1: SHA-1 Hash Function</h3>
        <div class="explanation">
          SHA-1 takes any input and produces a fixed 160-bit (40 hex characters)
          hash value. Try different inputs to see how even small changes produce
          completely different hashes.
        </div>

        <div class="input-group">
          <label>Plaintext (string):</label>
          <input
            id="input"
            name="user_input"
            size="40"
            type="text"
            value="test"
          />
          <button
            onclick="document.getElementById('hash_value').value = hex_sha1(document.getElementById('input').value)"
            type="button"
          >
            Calculate SHA-1
          </button>
        </div>

        <div class="input-group">
          <label>SHA-1 Hash output (hex):</label>
          <input
            id="hash_value"
            readonly="true"
            size="50"
            type="text"
            value=""
          />
        </div>
      </div>

      <!-- HMAC Section -->
      <div class="section">
        <h3>Part 2: HMAC Construction (Simplified Educational Version)</h3>
        <div class="explanation">
          HMAC combines a hash function with a secret key to provide both data
          integrity and authentication. This simulation uses a simplified
          "dummy" hash function for educational purposes.
        </div>

        <!-- Step 1: Parameters Setup -->
        <div class="step-section">
          <h4>Step 1: Setup Parameters</h4>

          <div class="input-group">
            <label>Message (binary):</label>
            <textarea cols="50" id="plaintext" name="plaintext" rows="2">
1100000000111100101010</textarea
            >
            <button
              name="changePlainText"
              onclick="next_plain_text()"
              type="button"
            >
              Generate Random Message
            </button>
            <div class="help-text">Binary message to be authenticated</div>
          </div>

          <div class="input-group">
            <label>Block size (l):</label>
            <input
              cols="4"
              id="l"
              name="l"
              type="number"
              value="8"
              min="8"
              max="16"
            />
            <div class="help-text">Hash function block size (must be ≥ 8)</div>
          </div>

          <div class="input-group">
            <label>Initialization Vector (IV):</label>
            <textarea cols="20" id="iv" name="iv" rows="1">11001100</textarea>
            <button name="changeIV" onclick="next_IV()" type="button">
              Generate Random IV
            </button>
            <div class="help-text">
              Random initialization vector of length l
            </div>
          </div>

          <div class="input-group">
            <label>Secret Key (k):</label>
            <textarea cols="20" id="key" name="key" rows="1">10000101</textarea>
            <button name="changeKey" onclick="next_Key()" type="button">
              Generate Random Key
            </button>
            <div class="help-text">Secret key of length l</div>
          </div>
        </div>

        <!-- Step 2: Hash Function Testing -->
        <div class="step-section">
          <h4>Step 2: Test the Dummy Hash Function</h4>
          <div class="explanation">
            Our simplified hash function XORs adjacent bit pairs: H(b1b2b3b4) =
            (b1⊕b2)(b3⊕b4)
          </div>

          <div class="input-group">
            <label>Test Input (2l bits):</label>
            <textarea cols="20" id="usertext" name="usertext" rows="1">
1100101011001010</textarea
            >
            <button name="getHash" onclick="get_hash()" type="button">
              Calculate Hash
            </button>
            <div class="help-text">
              Input must be exactly 2l bits (16 bits for l=8)
            </div>
          </div>

          <div class="input-group">
            <label>Hash Output (l bits):</label>
            <textarea
              cols="20"
              id="hashvalue"
              name="hashvalue"
              readonly="readonly"
              rows="1"
            ></textarea>
            <div class="help-text">Result of applying the hash function</div>
          </div>
        </div>

        <!-- Step 3: HMAC Calculation Guide -->
        <div class="step-section">
          <h4>Step 3: HMAC Calculation Guide</h4>
          <div class="explanation">
            HMAC follows this process:<br />
            1. ipad = 01011100, opad = 00110110<br />
            2. Inner hash: H(IV || (k ⊕ ipad) || padded_message || length)<br />
            3. Outer hash: H(IV || (k ⊕ opad) || inner_hash_result)
          </div>

          <div class="calculation-helper">
            <h5>Calculation Helper:</h5>
            <div id="hmac-steps"></div>
            <button onclick="showHMACSteps()" type="button">
              Show Step-by-Step Calculation
            </button>
          </div>
        </div>

        <!-- Step 4: Final Answer -->
        <div class="step-section">
          <h4>Step 4: Enter Final HMAC Result</h4>

          <div class="input-group">
            <label>Final HMAC Tag:</label>
            <textarea
              cols="20"
              id="cipherarea"
              name="output"
              rows="1"
            ></textarea>
            <button name="checkAnswer" onclick="checkAnswer()" type="button">
              Check Answer
            </button>
            <div class="help-text">Enter the final HMAC authentication tag</div>
          </div>

          <div id="notification" class="notification"></div>
        </div>
      </div>
    </div>

    <!-- Add JS at the bottom of HTML file -->
    <script src="js/hmac.js" type="application/javascript"></script>
    <script
      language="JavaScript"
      src="js/sha1.js"
      type="text/javascript"
    ></script>
    <script
      language="JavaScript"
      src="js/base64.js"
      type="text/javascript"
    ></script>
  </body>
</html>
